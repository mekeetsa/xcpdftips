%%
%% This is file `xcpdftips.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% xcpdftips.dtx  (with options: `package')
%% 
%% =============================================
%% IMPORTANT NOTICE:
%% 
%% This program is free software: you can redistribute it and/or modify
%% it under the terms of the GNU General Public License as published by
%% the Free Software Foundation, either version 3 of the License, or
%% (at your option) any later version.
%% 
%% This program is distributed in the hope that it will be useful,
%% but WITHOUT ANY WARRANTY; without even the implied warranty of
%% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%% GNU General Public License for more details.
%% 
%% You should have received a copy of the GNU General Public License
%% along with this program.  If not, see <https://www.gnu.org/licenses/>.
%% 
%% This is a generated file.
%% It may not be distributed without the original source file xcpdftips.dtx.
%% 
%% Full documentation can be obtained by LaTeXing that original file.
%% Only a few abbreviated comments remain here to describe the usage.
%% =============================================
%% 
%% Copyright (c) 2019 Mikica Kocic

\NeedsTeXFormat{LaTeX2e}

\ProvidesPackage{xcpdftips}
[2019/03/10 xcpdftips.sty v1.0 - (c) 2019 Mikica Kocic]

\RequirePackage{bibentry}
\RequirePackage{pdfcomment}
\RequirePackage{xparse}
\RequirePackage{etoolbox}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ExplSyntaxOn

\NewDocumentCommand{ \XC@enumeratetips }%
{ > { \SplitList , } m }%
{%
  \global\undef\XC@tips%
  \undef\XC@tipsPre%
  \tl_map_inline:nn {#1}%
  {%
    \ifx\XC@tips\undefined%
      \global\def\XC@tips{}%
      \gappto{\XC@tips}{\@nameuse{BR@r@##1\@extra@b@citeb}}%
    \else%
      \def\XC@tipsPre{\textbullet\ \ }
      \gappto{\XC@tips}{,\textCR\textbullet\ \ \@nameuse{BR@r@##1\@extra@b@citeb}}%
    \fi%
  }%
  \ifx\XC@tipsPre\undefined\else%
    \gpreto{\XC@tips}{\XC@tipsPre}%
  \fi%
}

\ExplSyntaxOff

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\gdef\XC@opt@author{{}}
\newcommand{\xcsetauthor}[1]{\gdef\XC@opt@author{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\gdef\XC@opt@markup{Underline}
\newcommand{\xcsetmarkup}[1]{\gdef\XC@opt@markup{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\gdef\XC@opt@color{1 1 0}
\newcommand{\xcsetcolor}[1]{\gdef\XC@opt@color{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\gdef\XC@opt@opacity{0}
\newcommand{\xcsetopacity}[1]{\gdef\XC@opt@opacity{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\XC@citetp{\@ifnextchar[{\XC@@citetp}{\XC@@citetp[]}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\XC@@citetp{}

\def\XC@@citetp[#1]{\@ifnextchar[{\XC@citex[#1]}{\XC@citex[][#1]}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\XC@citex{}

\def\XC@citex[#1][#2]#3%
  {%{\protect\NoHyper%
    \ifx\ocgtooltip\undefined%
      \XC@enumeratetips{#3}%
      \pdftooltip{\XC@oldcite[#1][#2]{#3}}{\XC@tips}%
      \pdfmarkupcomment[%
        author=\XC@opt@author,%
        markup=\XC@opt@markup,%
        color=\XC@opt@color,%
        opacity=\XC@opt@opacity,%
      ]{\vphantom{.}}{\XC@tips}%
    \else%
      \let\textCR\par%
      \XC@enumeratetips{#3}%
      \ocgtooltip{%
        {{\protect\NoHyper\XC@oldcite[#1][#2]{#3}\protect\endNoHyper}}%
      }{\parbox[t]{\columnwidth}{\normalsize\normalfont\XC@tips}}%
    \fi%
  }%\protect\endNoHyper}}

\let\XC@oldcite\citep  % Save \citep (in the case if it becomes redefined)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\let\xpdfcite\XC@citetp
\robustify{\xpdfcite}

\AtBeginDocument{\nobibliography*} % Necessary to get bibentries.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 
%% <<<<< End of generated file <<<<<<
%% 
%%
%% End of file `xcpdftips.sty'.
